import e from"./python-version-check.8185b27f.js";import t from"./python-version-check.54ff6aa6.js";import s from"./python-version-check.ebf2a848.js";import o from"./python-version-check.aa91ae7b.js";var c={},i=$4uTo6$pythonversioncheckebf2a848js2.kConnected,n=$4uTo6$pythonversioncheckebf2a848js9.kSize,r=$4uTo6$pythonversioncheckebf2a848js8.kRunning,h=$4uTo6$pythonversioncheckebf2a848js6.kPending,l=$4uTo6$pythonversioncheckebf2a848js7.kQueued,a=$4uTo6$pythonversioncheckebf2a848js.kBusy,d=$4uTo6$pythonversioncheckebf2a848js5.kFree,p=s.kUrl,m=$4uTo6$pythonversioncheckebf2a848js1.kClose,y=$4uTo6$pythonversioncheckebf2a848js3.kDestroy,k=$4uTo6$pythonversioncheckebf2a848js4.kDispatch;let u=Symbol("clients"),b=Symbol("needDrain"),H=Symbol("queue"),_=Symbol("closed resolve"),S=Symbol("onDrain"),f=Symbol("onConnect"),$=Symbol("onDisconnect"),E=Symbol("onConnectionError"),v=Symbol("get dispatcher"),R=Symbol("add client"),A=Symbol("remove client"),F=Symbol("stats");c={PoolBase:class extends e{constructor(){super(),this[H]=new t,this[u]=[],this[l]=0;let e=this;this[S]=function(t,s){let o=e[H],c=!1;for(;!c;){let t=o.shift();if(!t)break;e[l]--,c=!this.dispatch(t.opts,t.handler)}this[b]=c,!this[b]&&e[b]&&(e[b]=!1,e.emit("drain",t,[e,...s])),e[_]&&o.isEmpty()&&Promise.all(e[u].map(e=>e.close())).then(e[_])},this[f]=(t,s)=>{e.emit("connect",t,[e,...s])},this[$]=(t,s,o)=>{e.emit("disconnect",t,[e,...s],o)},this[E]=(t,s,o)=>{e.emit("connectionError",t,[e,...s],o)},this[F]=new o(this)}get[a](){return this[b]}get[i](){return this[u].filter(e=>e[i]).length}get[d](){return this[u].filter(e=>e[i]&&!e[b]).length}get[h](){let e=this[l];for(let{[h]:t}of this[u])e+=t;return e}get[r](){let e=0;for(let{[r]:t}of this[u])e+=t;return e}get[n](){let e=this[l];for(let{[n]:t}of this[u])e+=t;return e}get stats(){return this[F]}async [m](){return this[H].isEmpty()?Promise.all(this[u].map(e=>e.close())):new Promise(e=>{this[_]=e})}async [y](e){for(;;){let t=this[H].shift();if(!t)break;t.handler.onError(e)}return Promise.all(this[u].map(t=>t.destroy(e)))}[k](e,t){let s=this[v]();return s?s.dispatch(e,t)||(s[b]=!0,this[b]=!this[v]()):(this[b]=!0,this[H].push({opts:e,handler:t}),this[l]++),!this[b]}[R](e){return e.on("drain",this[S]).on("connect",this[f]).on("disconnect",this[$]).on("connectionError",this[E]),this[u].push(e),this[b]&&process.nextTick(()=>{this[b]&&this[S](e[p],[this,e])}),this}[A](e){e.close(()=>{let t=this[u].indexOf(e);-1!==t&&this[u].splice(t,1)}),this[b]=this[u].some(e=>!e[b]&&!0!==e.closed&&!0!==e.destroyed)}},kClients:u,kNeedDrain:b,kAddClient:R,kRemoveClient:A,kGetDispatcher:v};export{c as default};
//# sourceMappingURL=python-version-check.9d13d3dd.js.map
