import e from"./python-version-check.46dc70cc.js";import t from"./python-version-check.a7129567.js";import r from"./python-version-check.5450d47a.js";import*as s from"http";import*as o from"https";var i,n,a,l,u,d={},p=d&&d.__createBinding||(Object.create?function(e,t,r,s){void 0===s&&(s=r);var o=Object.getOwnPropertyDescriptor(t,r);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,o)}:function(e,t,r,s){void 0===s&&(s=r),e[s]=t[r]}),h=d&&d.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=d&&d.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return h(t,e),t},f=d&&d.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(o,i){function n(e){try{l(s.next(e))}catch(e){i(e)}}function a(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(n,a)}l((s=s.apply(e,t||[])).next())})};Object.defineProperty(d,"__esModule",{value:!0}),d.HttpClient=d.isHttps=d.HttpClientResponse=d.HttpClientError=d.getProxyUrl=d.MediaTypes=d.Headers=d.HttpCodes=void 0;let g=c(s),m=c(o),v=c(e),y=c(t);(i=a||(d.HttpCodes=a={}))[i.OK=200]="OK",i[i.MultipleChoices=300]="MultipleChoices",i[i.MovedPermanently=301]="MovedPermanently",i[i.ResourceMoved=302]="ResourceMoved",i[i.SeeOther=303]="SeeOther",i[i.NotModified=304]="NotModified",i[i.UseProxy=305]="UseProxy",i[i.SwitchProxy=306]="SwitchProxy",i[i.TemporaryRedirect=307]="TemporaryRedirect",i[i.PermanentRedirect=308]="PermanentRedirect",i[i.BadRequest=400]="BadRequest",i[i.Unauthorized=401]="Unauthorized",i[i.PaymentRequired=402]="PaymentRequired",i[i.Forbidden=403]="Forbidden",i[i.NotFound=404]="NotFound",i[i.MethodNotAllowed=405]="MethodNotAllowed",i[i.NotAcceptable=406]="NotAcceptable",i[i.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",i[i.RequestTimeout=408]="RequestTimeout",i[i.Conflict=409]="Conflict",i[i.Gone=410]="Gone",i[i.TooManyRequests=429]="TooManyRequests",i[i.InternalServerError=500]="InternalServerError",i[i.NotImplemented=501]="NotImplemented",i[i.BadGateway=502]="BadGateway",i[i.ServiceUnavailable=503]="ServiceUnavailable",i[i.GatewayTimeout=504]="GatewayTimeout",(n=l||(d.Headers=l={})).Accept="accept",n.ContentType="content-type",(u||(d.MediaTypes=u={})).ApplicationJson="application/json",d.getProxyUrl=function(e){let t=v.getProxyUrl(new URL(e));return t?t.href:""};let _=[a.MovedPermanently,a.ResourceMoved,a.SeeOther,a.TemporaryRedirect,a.PermanentRedirect],w=[a.BadGateway,a.ServiceUnavailable,a.GatewayTimeout],R=["OPTIONS","GET","DELETE","HEAD"];class A extends Error{constructor(e,t){super(e),this.name="HttpClientError",this.statusCode=t,Object.setPrototypeOf(this,A.prototype)}}d.HttpClientError=A;class O{constructor(e){this.message=e}readBody(){return f(this,void 0,void 0,function*(){return new Promise(e=>f(this,void 0,void 0,function*(){let t=Buffer.alloc(0);this.message.on("data",e=>{t=Buffer.concat([t,e])}),this.message.on("end",()=>{e(t.toString())})}))})}readBodyBuffer(){return f(this,void 0,void 0,function*(){return new Promise(e=>f(this,void 0,void 0,function*(){let t=[];this.message.on("data",e=>{t.push(e)}),this.message.on("end",()=>{e(Buffer.concat(t))})}))})}}d.HttpClientResponse=O,d.isHttps=function(e){return"https:"===new URL(e).protocol},d.HttpClient=class{constructor(e,t,r){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=e,this.handlers=t||[],this.requestOptions=r,r&&(null!=r.ignoreSslError&&(this._ignoreSslError=r.ignoreSslError),this._socketTimeout=r.socketTimeout,null!=r.allowRedirects&&(this._allowRedirects=r.allowRedirects),null!=r.allowRedirectDowngrade&&(this._allowRedirectDowngrade=r.allowRedirectDowngrade),null!=r.maxRedirects&&(this._maxRedirects=Math.max(r.maxRedirects,0)),null!=r.keepAlive&&(this._keepAlive=r.keepAlive),null!=r.allowRetries&&(this._allowRetries=r.allowRetries),null!=r.maxRetries&&(this._maxRetries=r.maxRetries))}options(e,t){return f(this,void 0,void 0,function*(){return this.request("OPTIONS",e,null,t||{})})}get(e,t){return f(this,void 0,void 0,function*(){return this.request("GET",e,null,t||{})})}del(e,t){return f(this,void 0,void 0,function*(){return this.request("DELETE",e,null,t||{})})}post(e,t,r){return f(this,void 0,void 0,function*(){return this.request("POST",e,t,r||{})})}patch(e,t,r){return f(this,void 0,void 0,function*(){return this.request("PATCH",e,t,r||{})})}put(e,t,r){return f(this,void 0,void 0,function*(){return this.request("PUT",e,t,r||{})})}head(e,t){return f(this,void 0,void 0,function*(){return this.request("HEAD",e,null,t||{})})}sendStream(e,t,r,s){return f(this,void 0,void 0,function*(){return this.request(e,t,r,s)})}getJson(e,t={}){return f(this,void 0,void 0,function*(){t[l.Accept]=this._getExistingOrDefaultHeader(t,l.Accept,u.ApplicationJson);let r=yield this.get(e,t);return this._processResponse(r,this.requestOptions)})}postJson(e,t,r={}){return f(this,void 0,void 0,function*(){let s=JSON.stringify(t,null,2);r[l.Accept]=this._getExistingOrDefaultHeader(r,l.Accept,u.ApplicationJson),r[l.ContentType]=this._getExistingOrDefaultHeader(r,l.ContentType,u.ApplicationJson);let o=yield this.post(e,s,r);return this._processResponse(o,this.requestOptions)})}putJson(e,t,r={}){return f(this,void 0,void 0,function*(){let s=JSON.stringify(t,null,2);r[l.Accept]=this._getExistingOrDefaultHeader(r,l.Accept,u.ApplicationJson),r[l.ContentType]=this._getExistingOrDefaultHeader(r,l.ContentType,u.ApplicationJson);let o=yield this.put(e,s,r);return this._processResponse(o,this.requestOptions)})}patchJson(e,t,r={}){return f(this,void 0,void 0,function*(){let s=JSON.stringify(t,null,2);r[l.Accept]=this._getExistingOrDefaultHeader(r,l.Accept,u.ApplicationJson),r[l.ContentType]=this._getExistingOrDefaultHeader(r,l.ContentType,u.ApplicationJson);let o=yield this.patch(e,s,r);return this._processResponse(o,this.requestOptions)})}request(e,t,r,s){return f(this,void 0,void 0,function*(){let o;if(this._disposed)throw Error("Client has already been disposed.");let i=new URL(t),n=this._prepareRequest(e,i,s),l=this._allowRetries&&R.includes(e)?this._maxRetries+1:1,u=0;do{if((o=yield this.requestRaw(n,r))&&o.message&&o.message.statusCode===a.Unauthorized){let e;for(let t of this.handlers)if(t.canHandleAuthentication(o)){e=t;break}if(e)return e.handleAuthentication(this,n,r);break}let t=this._maxRedirects;for(;o.message.statusCode&&_.includes(o.message.statusCode)&&this._allowRedirects&&t>0;){let a=o.message.headers.location;if(!a)break;let l=new URL(a);if("https:"===i.protocol&&i.protocol!==l.protocol&&!this._allowRedirectDowngrade)throw Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(yield o.readBody(),l.hostname!==i.hostname)for(let e in s)"authorization"===e.toLowerCase()&&delete s[e];n=this._prepareRequest(e,l,s),o=yield this.requestRaw(n,r),t--}if(!o.message.statusCode||!w.includes(o.message.statusCode))break;(u+=1)<l&&(yield o.readBody(),yield this._performExponentialBackoff(u))}while(u<l)return o})}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(e,t){return f(this,void 0,void 0,function*(){return new Promise((r,s)=>{this.requestRawWithCallback(e,t,function(e,t){e?s(e):t?r(t):s(Error("Unknown error"))})})})}requestRawWithCallback(e,t,r){let s;"string"==typeof t&&(e.options.headers||(e.options.headers={}),e.options.headers["Content-Length"]=Buffer.byteLength(t,"utf8"));let o=!1;function i(e,t){o||(o=!0,r(e,t))}let n=e.httpModule.request(e.options,e=>{i(void 0,new O(e))});n.on("socket",e=>{s=e}),n.setTimeout(this._socketTimeout||18e4,()=>{s&&s.end(),i(Error(`Request timeout: ${e.options.path}`))}),n.on("error",function(e){i(e)}),t&&"string"==typeof t&&n.write(t,"utf8"),t&&"string"!=typeof t?(t.on("close",function(){n.end()}),t.pipe(n)):n.end()}getAgent(e){let t=new URL(e);return this._getAgent(t)}getAgentDispatcher(e){let t=new URL(e),r=v.getProxyUrl(t);if(r&&r.hostname)return this._getProxyAgentDispatcher(t,r)}_prepareRequest(e,t,r){let s={};s.parsedUrl=t;let o="https:"===s.parsedUrl.protocol;if(s.httpModule=o?m:g,s.options={},s.options.host=s.parsedUrl.hostname,s.options.port=s.parsedUrl.port?parseInt(s.parsedUrl.port):o?443:80,s.options.path=(s.parsedUrl.pathname||"")+(s.parsedUrl.search||""),s.options.method=e,s.options.headers=this._mergeHeaders(r),null!=this.userAgent&&(s.options.headers["user-agent"]=this.userAgent),s.options.agent=this._getAgent(s.parsedUrl),this.handlers)for(let e of this.handlers)e.prepareRequest(s.options);return s}_mergeHeaders(e){return this.requestOptions&&this.requestOptions.headers?Object.assign({},x(this.requestOptions.headers),x(e||{})):x(e||{})}_getExistingOrDefaultHeader(e,t,r){let s;return this.requestOptions&&this.requestOptions.headers&&(s=x(this.requestOptions.headers)[t]),e[t]||s||r}_getAgent(e){let t,r=v.getProxyUrl(e),s=r&&r.hostname;if(this._keepAlive&&s&&(t=this._proxyAgent),s||(t=this._agent),t)return t;let o="https:"===e.protocol,i=100;if(this.requestOptions&&(i=this.requestOptions.maxSockets||g.globalAgent.maxSockets),r&&r.hostname){let e={maxSockets:i,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(r.username||r.password)&&{proxyAuth:`${r.username}:${r.password}`}),{host:r.hostname,port:r.port})},s="https:"===r.protocol;t=(o?s?y.httpsOverHttps:y.httpsOverHttp:s?y.httpOverHttps:y.httpOverHttp)(e),this._proxyAgent=t}if(!t){let e={keepAlive:this._keepAlive,maxSockets:i};t=o?new m.Agent(e):new g.Agent(e),this._agent=t}return o&&this._ignoreSslError&&(t.options=Object.assign(t.options||{},{rejectUnauthorized:!1})),t}_getProxyAgentDispatcher(e,t){let s;if(this._keepAlive&&(s=this._proxyAgentDispatcher),s)return s;let o="https:"===e.protocol;return s=new r.ProxyAgent(Object.assign({uri:t.href,pipelining:+!!this._keepAlive},(t.username||t.password)&&{token:`Basic ${Buffer.from(`${t.username}:${t.password}`).toString("base64")}`})),this._proxyAgentDispatcher=s,o&&this._ignoreSslError&&(s.options=Object.assign(s.options.requestTls||{},{rejectUnauthorized:!1})),s}_performExponentialBackoff(e){return f(this,void 0,void 0,function*(){let t=5*Math.pow(2,e=Math.min(10,e));return new Promise(e=>setTimeout(()=>e(),t))})}_processResponse(e,t){return f(this,void 0,void 0,function*(){return new Promise((r,s)=>f(this,void 0,void 0,function*(){let o,i,n=e.message.statusCode||0,l={statusCode:n,result:null,headers:{}};n===a.NotFound&&r(l);try{(i=yield e.readBody())&&i.length>0&&(l.result=o=t&&t.deserializeDates?JSON.parse(i,function(e,t){if("string"==typeof t){let e=new Date(t);if(!isNaN(e.valueOf()))return e}return t}):JSON.parse(i)),l.headers=e.message.headers}catch(e){}if(n>299){let e=new A(o&&o.message?o.message:i&&i.length>0?i:`Failed request: (${n})`,n);e.result=l.result,s(e)}else r(l)}))})}};let x=e=>Object.keys(e).reduce((t,r)=>(t[r.toLowerCase()]=e[r],t),{});export{d as default};
//# sourceMappingURL=python-version-check.c435cc7f.js.map
