import e from"./python-version-check.dba5a2d4.js";import t from"./python-version-check.ebf2a848.js";import o from"./python-version-check.8185b27f.js";import n from"./python-version-check.91f60e5c.js";import i from"./python-version-check.171f2d6c.js";import r from"./python-version-check.7ed1514e.js";import c from"./python-version-check.db32945b.js";import s from"./python-version-check.67cd42df.js";var h={},a=e.InvalidArgumentError,f=$gH1T0$pythonversioncheckebf2a848js.kClients,p=t.kRunning,l=$gH1T0$pythonversioncheckebf2a848js1.kClose,m=$gH1T0$pythonversioncheckebf2a848js2.kDestroy,y=$gH1T0$pythonversioncheckebf2a848js3.kDispatch,d=$gH1T0$pythonversioncheckebf2a848js4.kInterceptors;let{WeakRef:H,FinalizationRegistry:b}=s(),u=Symbol("onConnect"),_=Symbol("onDisconnect"),g=Symbol("onConnectionError"),v=Symbol("maxRedirections"),R=Symbol("onDrain"),S=Symbol("factory"),k=Symbol("finalizer"),A=Symbol("options");function E(e,t){return t&&1===t.connections?new i(e,t):new n(e,t)}h=class extends o{constructor({factory:e=E,maxRedirections:t=0,connect:o,...n}={}){if(super(),"function"!=typeof e)throw new a("factory must be a function.");if(null!=o&&"function"!=typeof o&&"object"!=typeof o)throw new a("connect must be a function or an object");if(!Number.isInteger(t)||t<0)throw new a("maxRedirections must be a positive number");o&&"function"!=typeof o&&(o={...o}),this[d]=n.interceptors&&n.interceptors.Agent&&Array.isArray(n.interceptors.Agent)?n.interceptors.Agent:[c({maxRedirections:t})],this[A]={...r.deepClone(n),connect:o},this[A].interceptors=n.interceptors?{...n.interceptors}:void 0,this[v]=t,this[S]=e,this[f]=new Map,this[k]=new b(e=>{let t=this[f].get(e);void 0!==t&&void 0===t.deref()&&this[f].delete(e)});let i=this;this[R]=(e,t)=>{i.emit("drain",e,[i,...t])},this[u]=(e,t)=>{i.emit("connect",e,[i,...t])},this[_]=(e,t,o)=>{i.emit("disconnect",e,[i,...t],o)},this[g]=(e,t,o)=>{i.emit("connectionError",e,[i,...t],o)}}get[p](){let e=0;for(let t of this[f].values()){let o=t.deref();o&&(e+=o[p])}return e}[y](e,t){let o;if(e.origin&&("string"==typeof e.origin||e.origin instanceof URL))o=String(e.origin);else throw new a("opts.origin must be a non-empty string or URL.");let n=this[f].get(o),i=n?n.deref():null;return i||(i=this[S](e.origin,this[A]).on("drain",this[R]).on("connect",this[u]).on("disconnect",this[_]).on("connectionError",this[g]),this[f].set(o,new H(i)),this[k].register(i,o)),i.dispatch(e,t)}async [l](){let e=[];for(let t of this[f].values()){let o=t.deref();o&&e.push(o.close())}await Promise.all(e)}async [m](e){let t=[];for(let o of this[f].values()){let n=o.deref();n&&t.push(n.destroy(e))}await Promise.all(t)}};export{h as default};
//# sourceMappingURL=python-version-check.c2bfca41.js.map
