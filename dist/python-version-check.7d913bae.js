import t from"./python-version-check.b159b006.js";import e from"./python-version-check.63be8bf3.js";import*as s from"os";import*as r from"events";import*as i from"child_process";import*as o from"path";import{setTimeout as n}from"timers";var l=globalThis,h={},d={},a=l.parcelRequire5a65;null==a&&((a=function(t){if(t in h)return h[t].exports;if(t in d){var e=d[t];delete d[t];var s={id:t,exports:{}};return h[t]=s,e.call(s.exports,s,s.exports),s.exports}var r=Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(t,e){d[t]=e},l.parcelRequire5a65=a),(0,a.register)("8VyS8",function(l,h){var d=l.exports&&l.exports.__createBinding||(Object.create?function(t,e,s,r){void 0===r&&(r=s),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[s]}})}:function(t,e,s,r){void 0===r&&(r=s),t[r]=e[s]}),a=l.exports&&l.exports.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=l.exports&&l.exports.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var s in t)"default"!==s&&Object.hasOwnProperty.call(t,s)&&d(e,t,s);return a(e,t),e},c=l.exports&&l.exports.__awaiter||function(t,e,s,r){return new(s||(s=Promise))(function(i,o){function n(t){try{h(r.next(t))}catch(t){o(t)}}function l(t){try{h(r.throw(t))}catch(t){o(t)}}function h(t){var e;t.done?i(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(n,l)}h((r=r.apply(t,e||[])).next())})};Object.defineProperty(l.exports,"__esModule",{value:!0}),l.exports.argStringToArray=l.exports.ToolRunner=void 0;let p=u(s),m=u(r),f=u(i),g=u(o),w=u(t),_=u(e),x="win32"===process.platform;class E extends m.EventEmitter{constructor(t,e,s){if(super(),!t)throw Error("Parameter 'toolPath' cannot be null or empty.");this.toolPath=t,this.args=e||[],this.options=s||{}}_debug(t){this.options.listeners&&this.options.listeners.debug&&this.options.listeners.debug(t)}_getCommandString(t,e){let s=this._getSpawnFileName(),r=this._getSpawnArgs(t),i=e?"":"[command]";if(x)if(this._isCmdFile())for(let t of(i+=s,r))i+=` ${t}`;else if(t.windowsVerbatimArguments)for(let t of(i+=`"${s}"`,r))i+=` ${t}`;else for(let t of(i+=this._windowsQuoteCmdArg(s),r))i+=` ${this._windowsQuoteCmdArg(t)}`;else for(let t of(i+=s,r))i+=` ${t}`;return i}_processLineBuffer(t,e,s){try{let r=e+t.toString(),i=r.indexOf(p.EOL);for(;i>-1;){let t=r.substring(0,i);s(t),i=(r=r.substring(i+p.EOL.length)).indexOf(p.EOL)}return r}catch(t){return this._debug(`error processing line. Failed with error ${t}`),""}}_getSpawnFileName(){return x&&this._isCmdFile()?process.env.COMSPEC||"cmd.exe":this.toolPath}_getSpawnArgs(t){if(x&&this._isCmdFile()){let e=`/D /S /C "${this._windowsQuoteCmdArg(this.toolPath)}`;for(let s of this.args)e+=" ",e+=t.windowsVerbatimArguments?s:this._windowsQuoteCmdArg(s);return[e+='"']}return this.args}_endsWith(t,e){return t.endsWith(e)}_isCmdFile(){let t=this.toolPath.toUpperCase();return this._endsWith(t,".CMD")||this._endsWith(t,".BAT")}_windowsQuoteCmdArg(t){if(!this._isCmdFile())return this._uvQuoteCmdArg(t);if(!t)return'""';let e=[" ","	","&","(",")","[","]","{","}","^","=",";","!","'","+",",","`","~","|","<",">",'"'],s=!1;for(let r of t)if(e.some(t=>t===r)){s=!0;break}if(!s)return t;let r='"',i=!0;for(let e=t.length;e>0;e--)r+=t[e-1],i&&"\\"===t[e-1]?r+="\\":'"'===t[e-1]?(i=!0,r+='"'):i=!1;return(r+='"').split("").reverse().join("")}_uvQuoteCmdArg(t){if(!t)return'""';if(!t.includes(" ")&&!t.includes("	")&&!t.includes('"'))return t;if(!t.includes('"')&&!t.includes("\\"))return`"${t}"`;let e='"',s=!0;for(let r=t.length;r>0;r--)e+=t[r-1],s&&"\\"===t[r-1]?e+="\\":'"'===t[r-1]?(s=!0,e+="\\"):s=!1;return(e+='"').split("").reverse().join("")}_cloneExecOptions(t){let e={cwd:(t=t||{}).cwd||process.cwd(),env:t.env||process.env,silent:t.silent||!1,windowsVerbatimArguments:t.windowsVerbatimArguments||!1,failOnStdErr:t.failOnStdErr||!1,ignoreReturnCode:t.ignoreReturnCode||!1,delay:t.delay||1e4};return e.outStream=t.outStream||process.stdout,e.errStream=t.errStream||process.stderr,e}_getSpawnOptions(t,e){let s={};return s.cwd=(t=t||{}).cwd,s.env=t.env,s.windowsVerbatimArguments=t.windowsVerbatimArguments||this._isCmdFile(),t.windowsVerbatimArguments&&(s.argv0=`"${e}"`),s}exec(){return c(this,void 0,void 0,function*(){return!_.isRooted(this.toolPath)&&(this.toolPath.includes("/")||x&&this.toolPath.includes("\\"))&&(this.toolPath=g.resolve(process.cwd(),this.options.cwd||process.cwd(),this.toolPath)),this.toolPath=yield w.which(this.toolPath,!0),new Promise((t,e)=>c(this,void 0,void 0,function*(){for(let t of(this._debug(`exec tool: ${this.toolPath}`),this._debug("arguments:"),this.args))this._debug(`   ${t}`);let s=this._cloneExecOptions(this.options);!s.silent&&s.outStream&&s.outStream.write(this._getCommandString(s)+p.EOL);let r=new C(s,this.toolPath);if(r.on("debug",t=>{this._debug(t)}),this.options.cwd&&!(yield _.exists(this.options.cwd)))return e(Error(`The cwd: ${this.options.cwd} does not exist!`));let i=this._getSpawnFileName(),o=f.spawn(i,this._getSpawnArgs(s),this._getSpawnOptions(this.options,i)),n="";o.stdout&&o.stdout.on("data",t=>{this.options.listeners&&this.options.listeners.stdout&&this.options.listeners.stdout(t),!s.silent&&s.outStream&&s.outStream.write(t),n=this._processLineBuffer(t,n,t=>{this.options.listeners&&this.options.listeners.stdline&&this.options.listeners.stdline(t)})});let l="";if(o.stderr&&o.stderr.on("data",t=>{r.processStderr=!0,this.options.listeners&&this.options.listeners.stderr&&this.options.listeners.stderr(t),!s.silent&&s.errStream&&s.outStream&&(s.failOnStdErr?s.errStream:s.outStream).write(t),l=this._processLineBuffer(t,l,t=>{this.options.listeners&&this.options.listeners.errline&&this.options.listeners.errline(t)})}),o.on("error",t=>{r.processError=t.message,r.processExited=!0,r.processClosed=!0,r.CheckComplete()}),o.on("exit",t=>{r.processExitCode=t,r.processExited=!0,this._debug(`Exit code ${t} received from tool '${this.toolPath}'`),r.CheckComplete()}),o.on("close",t=>{r.processExitCode=t,r.processExited=!0,r.processClosed=!0,this._debug(`STDIO streams have closed for tool '${this.toolPath}'`),r.CheckComplete()}),r.on("done",(s,r)=>{n.length>0&&this.emit("stdline",n),l.length>0&&this.emit("errline",l),o.removeAllListeners(),s?e(s):t(r)}),this.options.input){if(!o.stdin)throw Error("child process missing stdin");o.stdin.end(this.options.input)}}))})}}l.exports.ToolRunner=E,l.exports.argStringToArray=function(t){let e=[],s=!1,r=!1,i="";function o(t){r&&'"'!==t&&(i+="\\"),i+=t,r=!1}for(let n=0;n<t.length;n++){let l=t.charAt(n);if('"'===l){r?o(l):s=!s;continue}if("\\"===l&&r){o(l);continue}if("\\"===l&&s){r=!0;continue}if(" "===l&&!s){i.length>0&&(e.push(i),i="");continue}o(l)}return i.length>0&&e.push(i.trim()),e};class C extends m.EventEmitter{constructor(t,e){if(super(),this.processClosed=!1,this.processError="",this.processExitCode=0,this.processExited=!1,this.processStderr=!1,this.delay=1e4,this.done=!1,this.timeout=null,!e)throw Error("toolPath must not be empty");this.options=t,this.toolPath=e,t.delay&&(this.delay=t.delay)}CheckComplete(){!this.done&&(this.processClosed?this._setResult():this.processExited&&(this.timeout=n(C.HandleTimeout,this.delay,this)))}_debug(t){this.emit("debug",t)}_setResult(){let t;this.processExited&&(this.processError?t=Error(`There was an error when attempting to execute the process '${this.toolPath}'. This may indicate the process failed to start. Error: ${this.processError}`):0===this.processExitCode||this.options.ignoreReturnCode?this.processStderr&&this.options.failOnStdErr&&(t=Error(`The process '${this.toolPath}' failed because one or more lines were written to the STDERR stream`)):t=Error(`The process '${this.toolPath}' failed with exit code ${this.processExitCode}`)),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.done=!0,this.emit("done",t,this.processExitCode)}static HandleTimeout(t){if(!t.done){if(!t.processClosed&&t.processExited){let e=`The STDIO streams did not close within ${t.delay/1e3} seconds of the exit event from process '${t.toolPath}'. This may indicate a child process inherited the STDIO streams and has not yet exited.`;t._debug(e)}t._setResult()}}}}),a("8VyS8");
//# sourceMappingURL=python-version-check.7d913bae.js.map
