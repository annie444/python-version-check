import t from"./python-version-check.7ed1514e.js";import o from"./python-version-check.ebf2a848.js";import s from"./python-version-check.dba5a2d4.js";import*as e from"assert";import{prototype as i}from"events";var n={},h=o.kBodyUsed,r=s.InvalidArgumentError;let a=[300,301,302,303,307,308],c=Symbol("body");class d{constructor(t){this[c]=t,this[h]=!1}async *[Symbol.asyncIterator](){e(!this[h],"disturbed"),this[h]=!0,yield*this[c]}}function p(t,o,s){if(4===t.length)return"host"===$dubPj$pythonversioncheck7ed1514ejs1.headerNameToString(t);if(o&&$dubPj$pythonversioncheck7ed1514ejs1.headerNameToString(t).startsWith("content-"))return!0;if(s&&(13===t.length||6===t.length||19===t.length)){let o=$dubPj$pythonversioncheck7ed1514ejs1.headerNameToString(t);return"authorization"===o||"cookie"===o||"proxy-authorization"===o}return!1}n=class{constructor(o,s,n,a){if(null!=s&&(!Number.isInteger(s)||s<0))throw new r("maxRedirections must be a positive number");t.validateHandler(a,n.method,n.upgrade),this.dispatch=o,this.location=null,this.abort=null,this.opts={...n,maxRedirections:0},this.maxRedirections=s,this.handler=a,this.history=[],$dubPj$pythonversioncheck7ed1514ejs4.isStream(this.opts.body)?(0===$dubPj$pythonversioncheck7ed1514ejs.bodyLength(this.opts.body)&&this.opts.body.on("data",function(){e(!1)}),"boolean"!=typeof this.opts.body.readableDidRead&&(this.opts.body[h]=!1,i.on.call(this.opts.body,"data",function(){this[h]=!0}))):this.opts.body&&"function"==typeof this.opts.body.pipeTo?this.opts.body=new d(this.opts.body):this.opts.body&&"string"!=typeof this.opts.body&&!ArrayBuffer.isView(this.opts.body)&&$dubPj$pythonversioncheck7ed1514ejs3.isIterable(this.opts.body)&&(this.opts.body=new d(this.opts.body))}onConnect(t){this.abort=t,this.handler.onConnect(t,{history:this.history})}onUpgrade(t,o,s){this.handler.onUpgrade(t,o,s)}onError(t){this.handler.onError(t)}onHeaders(t,o,s,i){if(this.location=this.history.length>=this.maxRedirections||$dubPj$pythonversioncheck7ed1514ejs2.isDisturbed(this.opts.body)?null:function(t,o){if(-1===a.indexOf(t))return null;for(let t=0;t<o.length;t+=2)if("location"===o[t].toString().toLowerCase())return o[t+1]}(t,o),this.opts.origin&&this.history.push(new URL(this.opts.path,this.opts.origin)),!this.location)return this.handler.onHeaders(t,o,s,i);let{origin:n,pathname:h,search:r}=$dubPj$pythonversioncheck7ed1514ejs5.parseURL(new URL(this.location,this.opts.origin&&new URL(this.opts.path,this.opts.origin))),c=r?`${h}${r}`:h;this.opts.headers=function(t,o,s){let i=[];if(Array.isArray(t))for(let e=0;e<t.length;e+=2)p(t[e],o,s)||i.push(t[e],t[e+1]);else if(t&&"object"==typeof t)for(let e of Object.keys(t))p(e,o,s)||i.push(e,t[e]);else e(null==t,"headers must be an object or an array");return i}(this.opts.headers,303===t,this.opts.origin!==n),this.opts.path=c,this.opts.origin=n,this.opts.maxRedirections=0,this.opts.query=null,303===t&&"HEAD"!==this.opts.method&&(this.opts.method="GET",this.opts.body=null)}onData(t){if(!this.location)return this.handler.onData(t)}onComplete(t){this.location?(this.location=null,this.abort=null,this.dispatch(this.opts,this)):this.handler.onComplete(t)}onBodySent(t){this.handler.onBodySent&&this.handler.onBodySent(t)}};export{n as default};
//# sourceMappingURL=python-version-check.f05b4667.js.map
