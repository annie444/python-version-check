import e from"./python-version-check.7452b75a.js";import t from"./python-version-check.32039d93.js";import r from"./python-version-check.7ed1514e.js";import{STATUS_CODES as o}from"http";import*as n from"util";var i={},a=e.MockNotMatchedError,s=$8pGVa$pythonversioncheck32039d93js.kDispatches,c=$8pGVa$pythonversioncheck32039d93js2.kMockAgent,f=t.kOriginalDispatch,h=$8pGVa$pythonversioncheck32039d93js3.kOrigin,u=$8pGVa$pythonversioncheck32039d93js1.kGetNetConnect,d=$8pGVa$pythonversioncheck7ed1514ejs.buildURL,l=r.nop;let{types:{isPromise:p}}=n;function y(e,t){return"string"==typeof e?e===t:e instanceof RegExp?e.test(t):"function"==typeof e&&!0===e(t)}function m(e){return Object.fromEntries(Object.entries(e).map(([e,t])=>[e.toLocaleLowerCase(),t]))}function b(e,t){if(Array.isArray(e)){for(let r=0;r<e.length;r+=2)if(e[r].toLocaleLowerCase()===t.toLocaleLowerCase())return e[r+1];return}return"function"==typeof e.get?e.get(t):m(e)[t.toLocaleLowerCase()]}function g(e){let t=e.slice(),r=[];for(let e=0;e<t.length;e+=2)r.push([t[e],t[e+1]]);return Object.fromEntries(r)}function k(e,t){if("function"==typeof e.headers)return Array.isArray(t)&&(t=g(t)),e.headers(t?m(t):{});if(void 0===e.headers)return!0;if("object"!=typeof t||"object"!=typeof e.headers)return!1;for(let[r,o]of Object.entries(e.headers))if(!y(o,b(t,r)))return!1;return!0}function w(e){if("string"!=typeof e)return e;let t=e.split("?");if(2!==t.length)return e;let r=new URLSearchParams(t.pop());return r.sort(),[...t,r.toString()].join("?")}function $(e){return Buffer.isBuffer(e)?e:"object"==typeof e?JSON.stringify(e):e.toString()}function A(e,t){let r=t.query?d(t.path,t.query):t.path,o="string"==typeof r?w(r):r,n=e.filter(({consumed:e})=>!e).filter(({path:e})=>y(w(e),o));if(0===n.length)throw new a(`Mock dispatch not matched for path '${o}'`);if(0===(n=n.filter(({method:e})=>y(e,t.method))).length)throw new a(`Mock dispatch not matched for method '${t.method}'`);if(0===(n=n.filter(({body:e})=>void 0===e||y(e,t.body))).length)throw new a(`Mock dispatch not matched for body '${t.body}'`);if(0===(n=n.filter(e=>k(e,t.headers))).length)throw new a(`Mock dispatch not matched for headers '${"object"==typeof t.headers?JSON.stringify(t.headers):t.headers}'`);return n[0]}function j(e,t){let r=e.findIndex(e=>!!e.consumed&&function(e,{path:t,method:r,body:o,headers:n}){let i=y(e.path,t),a=y(e.method,r),s=void 0===e.body||y(e.body,o),c=k(e,n);return i&&a&&s&&c}(e,t));-1!==r&&e.splice(r,1)}function H(e){let{path:t,method:r,body:o,headers:n,query:i}=e;return{path:t,method:r,body:o,headers:n,query:i}}function S(e){return Object.entries(e).reduce((e,[t,r])=>[...e,Buffer.from(`${t}`),Array.isArray(r)?r.map(e=>Buffer.from(`${e}`)):Buffer.from(`${r}`)],[])}function v(e){return o[e]||"unknown"}function _(e,t){let r=H(e),o=A(this[s],r);o.timesInvoked++,o.data.callback&&(o.data={...o.data,...o.data.callback(e)});let{data:{statusCode:n,data:i,headers:a,trailers:c,error:f},delay:h,persist:u}=o,{timesInvoked:d,times:y}=o;if(o.consumed=!u&&d>=y,o.pending=d<y,null!==f)return j(this[s],r),t.onError(f),!0;function m(o,s=i){let f=Array.isArray(e.headers)?g(e.headers):e.headers,h="function"==typeof s?s({...e,headers:f}):s;if(p(h))return void h.then(e=>m(o,e));let u=$(h),d=S(a),y=S(c);t.abort=l,t.onHeaders(n,d,b,v(n)),t.onData(Buffer.from(u)),t.onComplete(y),j(o,r)}function b(){}return"number"==typeof h&&h>0?setTimeout(()=>{m(this[s])},h):m(this[s]),!0}function E(e,t){let r=new URL(t);return!0===e||!!(Array.isArray(e)&&e.some(e=>y(e,r.host)))}i={getResponseData:$,getMockDispatch:A,addMockDispatch:function(e,t,r){let o="function"==typeof r?{callback:r}:{...r},n={...{timesInvoked:0,times:1,persist:!1,consumed:!1},...t,pending:!0,data:{error:null,...o}};return e.push(n),n},deleteMockDispatch:j,buildKey:H,generateKeyValues:S,matchValue:y,getResponse:async function e(e){let t=[];for await(let r of e)t.push(r);return Buffer.concat(t).toString("utf8")},getStatusText:v,mockDispatch:_,buildMockDispatch:function(){let e=this[c],t=this[h],r=this[f];return function(o,n){if(e.isMockActive)try{_.call(this,o,n)}catch(i){if(i instanceof a){let s=e[u]();if(!1===s)throw new a(`${i.message}: subsequent request to origin ${t} was not allowed (net.connect disabled)`);if(E(s,t))r.call(this,o,n);else throw new a(`${i.message}: subsequent request to origin ${t} was not allowed (net.connect is not enabled for this origin)`)}else throw i}else r.call(this,o,n)}},checkNetConnect:E,buildMockOptions:function(e){if(e){let{agent:t,...r}=e;return r}},getHeaderByName:b};export{i as default};
//# sourceMappingURL=python-version-check.3b10f8a1.js.map
