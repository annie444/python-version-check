let e;import t from"./python-version-check.7ed1514e.js";import n from"./python-version-check.715a24ba.js";import s from"./python-version-check.2f514258.js";import o from"./python-version-check.8185b27f.js";import r from"./python-version-check.dba5a2d4.js";import c from"./python-version-check.091f3542.js";import i from"./python-version-check.ebf2a848.js";import h from"./python-version-check.67e8c7c6.js";import a from"./python-version-check.db32945b.js";import l from"./python-version-check.e57c179e.js";import u from"./python-version-check.f30ce740.js";import*as d from"assert";import{isIP as f}from"net";import{maxHeaderSize as p}from"http";import{pipeline as k}from"stream";var y={},m=$16nGk$pythonversioncheckdba5a2d4js8.RequestContentLengthMismatchError,H=$16nGk$pythonversioncheckdba5a2d4js9.ResponseContentLengthMismatchError,_=$16nGk$pythonversioncheckdba5a2d4js6.InvalidArgumentError,$=$16nGk$pythonversioncheckdba5a2d4js7.RequestAbortedError,S=$16nGk$pythonversioncheckdba5a2d4js3.HeadersTimeoutError,E=$16nGk$pythonversioncheckdba5a2d4js2.HeadersOverflowError,b=r.SocketError,v=$16nGk$pythonversioncheckdba5a2d4js5.InformationalError,R=$16nGk$pythonversioncheckdba5a2d4js.BodyTimeoutError,A=$16nGk$pythonversioncheckdba5a2d4js4.HTTPParserError,g=$16nGk$pythonversioncheckdba5a2d4js10.ResponseExceededMaxSizeError,F=$16nGk$pythonversioncheckdba5a2d4js1.ClientDestroyedError,w=$16nGk$pythonversioncheckebf2a848js47.kUrl,T=$16nGk$pythonversioncheckebf2a848js39.kReset,j=$16nGk$pythonversioncheckebf2a848js43.kServerName,G=$16nGk$pythonversioncheckebf2a848js3.kClient,C=$16nGk$pythonversioncheckebf2a848js2.kBusy,P=$16nGk$pythonversioncheckebf2a848js34.kParser,x=$16nGk$pythonversioncheckebf2a848js5.kConnect,L=$16nGk$pythonversioncheckebf2a848js.kBlocking,q=$16nGk$pythonversioncheckebf2a848js40.kResuming,N=$16nGk$pythonversioncheckebf2a848js41.kRunning,D=$16nGk$pythonversioncheckebf2a848js35.kPending,O=$16nGk$pythonversioncheckebf2a848js44.kSize,I=i.kWriting,M=$16nGk$pythonversioncheckebf2a848js38.kQueue,B=$16nGk$pythonversioncheckebf2a848js6.kConnected,U=$16nGk$pythonversioncheckebf2a848js7.kConnecting,z=$16nGk$pythonversioncheckebf2a848js32.kNeedDrain,K=$16nGk$pythonversioncheckebf2a848js33.kNoRef,W=$16nGk$pythonversioncheckebf2a848js23.kKeepAliveDefaultTimeout,V=$16nGk$pythonversioncheckebf2a848js15.kHostHeader,Y=$16nGk$pythonversioncheckebf2a848js36.kPendingIdx,J=$16nGk$pythonversioncheckebf2a848js42.kRunningIdx,Q=$16nGk$pythonversioncheckebf2a848js12.kError,X=$16nGk$pythonversioncheckebf2a848js37.kPipelining,Z=$16nGk$pythonversioncheckebf2a848js45.kSocket,ee=$16nGk$pythonversioncheckebf2a848js26.kKeepAliveTimeoutValue,et=$16nGk$pythonversioncheckebf2a848js28.kMaxHeadersSize,en=$16nGk$pythonversioncheckebf2a848js24.kKeepAliveMaxTimeout,es=$16nGk$pythonversioncheckebf2a848js25.kKeepAliveTimeoutThreshold,eo=$16nGk$pythonversioncheckebf2a848js13.kHeadersTimeout,er=$16nGk$pythonversioncheckebf2a848js1.kBodyTimeout,ec=$16nGk$pythonversioncheckebf2a848js46.kStrictContentLength,ei=$16nGk$pythonversioncheckebf2a848js8.kConnector,eh=$16nGk$pythonversioncheckebf2a848js29.kMaxRedirections,ea=$16nGk$pythonversioncheckebf2a848js30.kMaxRequests,el=$16nGk$pythonversioncheckebf2a848js9.kCounter,eu=$16nGk$pythonversioncheckebf2a848js4.kClose,ed=$16nGk$pythonversioncheckebf2a848js10.kDestroy,ef=$16nGk$pythonversioncheckebf2a848js11.kDispatch,ep=$16nGk$pythonversioncheckebf2a848js22.kInterceptors,ek=$16nGk$pythonversioncheckebf2a848js27.kLocalAddress,ey=$16nGk$pythonversioncheckebf2a848js31.kMaxResponseSize,em=$16nGk$pythonversioncheckebf2a848js21.kHTTPConnVersion,eH=$16nGk$pythonversioncheckebf2a848js14.kHost,e_=$16nGk$pythonversioncheckebf2a848js19.kHTTP2Session,e$=$16nGk$pythonversioncheckebf2a848js20.kHTTP2SessionState,eS=$16nGk$pythonversioncheckebf2a848js17.kHTTP2BuildRequest,eE=$16nGk$pythonversioncheckebf2a848js18.kHTTP2CopyHeaders,eb=$16nGk$pythonversioncheckebf2a848js16.kHTTP1BuildRequest;try{e=$5c97a5b8760057fe$import$7690c58d6bf1df8f}catch{e={constants:{}}}let{constants:{HTTP2_HEADER_AUTHORITY:ev,HTTP2_HEADER_METHOD:eR,HTTP2_HEADER_PATH:eA,HTTP2_HEADER_SCHEME:eg,HTTP2_HEADER_CONTENT_LENGTH:eF,HTTP2_HEADER_EXPECT:ew,HTTP2_HEADER_STATUS:eT}}=e,ej=!1,eG=Buffer[Symbol.species],eC=Symbol("kClosedResolve"),eP={};try{let e=$5c97a5b8760057fe$import$b63e509c7dd4e53f;eP.sendHeaders=e.channel("undici:client:sendHeaders"),eP.beforeConnect=e.channel("undici:client:beforeConnect"),eP.connectError=e.channel("undici:client:connectError"),eP.connected=e.channel("undici:client:connected")}catch{eP.sendHeaders={hasSubscribers:!1},eP.beforeConnect={hasSubscribers:!1},eP.connectError={hasSubscribers:!1},eP.connected={hasSubscribers:!1}}function ex(e){d("ERR_TLS_CERT_ALTNAME_INVALID"!==e.code),this[Z][Q]=e,eJ(this[G],e)}function eL(e,t,n){let s=new v(`HTTP/2: "frameError" received - type ${e}, code ${t}`);0===n&&(this[Z][Q]=s,eJ(this[G],s))}function eq(){$16nGk$pythonversioncheck7ed1514ejs1.destroy(this,new b("other side closed")),$16nGk$pythonversioncheck7ed1514ejs1.destroy(this[Z],new b("other side closed"))}function eN(e){let t=this[G],n=new v(`HTTP/2: "GOAWAY" frame received with code ${e}`);if(t[Z]=null,t[e_]=null,t.destroyed){d(0===this[D]);let e=t[M].splice(t[J]);for(let t=0;t<e.length;t++)e8(this,e[t],n)}else if(t[N]>0){let e=t[M][t[J]];t[M][t[J]++]=null,e8(t,e,n)}t[Y]=t[J],d(0===t[N]),t.emit("disconnect",t[w],[t],n),e0(t)}let eD=Buffer.alloc(0),eO=null,eI=async function(){let e,t=process.env.JEST_WORKER_ID?l:void 0;try{e=await WebAssembly.compile(Buffer.from(u,"base64"))}catch(n){e=await WebAssembly.compile(Buffer.from(t||l,"base64"))}return await WebAssembly.instantiate(e,{env:{wasm_on_url:(e,t,n)=>0,wasm_on_status:(e,t,n)=>{d.strictEqual(eM.ptr,e);let s=t-ez+eB.byteOffset;return eM.onStatus(new eG(eB.buffer,s,n))||0},wasm_on_message_begin:e=>(d.strictEqual(eM.ptr,e),eM.onMessageBegin()||0),wasm_on_header_field:(e,t,n)=>{d.strictEqual(eM.ptr,e);let s=t-ez+eB.byteOffset;return eM.onHeaderField(new eG(eB.buffer,s,n))||0},wasm_on_header_value:(e,t,n)=>{d.strictEqual(eM.ptr,e);let s=t-ez+eB.byteOffset;return eM.onHeaderValue(new eG(eB.buffer,s,n))||0},wasm_on_headers_complete:(e,t,n,s)=>(d.strictEqual(eM.ptr,e),eM.onHeadersComplete(t,!!n,!!s)||0),wasm_on_body:(e,t,n)=>{d.strictEqual(eM.ptr,e);let s=t-ez+eB.byteOffset;return eM.onBody(new eG(eB.buffer,s,n))||0},wasm_on_message_complete:e=>(d.strictEqual(eM.ptr,e),eM.onMessageComplete()||0)}})}();eI.catch();let eM=null,eB=null,eU=0,ez=null;class eK{constructor(e,t,{exports:n}){d(Number.isFinite(e[et])&&e[et]>0),this.llhttp=n,this.ptr=this.llhttp.llhttp_alloc(h.TYPE.RESPONSE),this.client=e,this.socket=t,this.timeout=null,this.timeoutValue=null,this.timeoutType=null,this.statusCode=null,this.statusText="",this.upgrade=!1,this.headers=[],this.headersSize=0,this.headersMaxSize=e[et],this.shouldKeepAlive=!1,this.paused=!1,this.resume=this.resume.bind(this),this.bytesRead=0,this.keepAlive="",this.contentLength="",this.connection="",this.maxResponseSize=e[ey]}setTimeout(e,t){this.timeoutType=t,e!==this.timeoutValue?($16nGk$pythonversioncheck715a24bajs.clearTimeout(this.timeout),e?(this.timeout=n.setTimeout(eW,e,this),this.timeout.unref&&this.timeout.unref()):this.timeout=null,this.timeoutValue=e):this.timeout&&this.timeout.refresh&&this.timeout.refresh()}resume(){!this.socket.destroyed&&this.paused&&(d(null!=this.ptr),d(null==eM),this.llhttp.llhttp_resume(this.ptr),d(2===this.timeoutType),this.timeout&&this.timeout.refresh&&this.timeout.refresh(),this.paused=!1,this.execute(this.socket.read()||eD),this.readMore())}readMore(){for(;!this.paused&&this.ptr;){let e=this.socket.read();if(null===e)break;this.execute(e)}}execute(e){d(null!=this.ptr),d(null==eM),d(!this.paused);let{socket:t,llhttp:n}=this;e.length>eU&&(ez&&n.free(ez),eU=4096*Math.ceil(e.length/4096),ez=n.malloc(eU)),new Uint8Array(n.memory.buffer,ez,eU).set(e);try{let s;try{eB=e,eM=this,s=n.llhttp_execute(this.ptr,ez,e.length)}catch(e){throw e}finally{eM=null,eB=null}let o=n.llhttp_get_error_pos(this.ptr)-ez;if(s===$16nGk$pythonversioncheck67e8c7c6js.ERROR.PAUSED_UPGRADE)this.onUpgrade(e.slice(o));else if(s===$16nGk$pythonversioncheck67e8c7c6js.ERROR.PAUSED)this.paused=!0,t.unshift(e.slice(o));else if(s!==$16nGk$pythonversioncheck67e8c7c6js.ERROR.OK){let t=n.llhttp_get_error_reason(this.ptr),r="";if(t){let e=new Uint8Array(n.memory.buffer,t).indexOf(0);r="Response does not match the HTTP/1.1 protocol ("+Buffer.from(n.memory.buffer,t,e).toString()+")"}throw new A(r,$16nGk$pythonversioncheck67e8c7c6js.ERROR[s],e.slice(o))}}catch(e){$16nGk$pythonversioncheck7ed1514ejs1.destroy(t,e)}}destroy(){d(null!=this.ptr),d(null==eM),this.llhttp.llhttp_free(this.ptr),this.ptr=null,$16nGk$pythonversioncheck715a24bajs.clearTimeout(this.timeout),this.timeout=null,this.timeoutValue=null,this.timeoutType=null,this.paused=!1}onStatus(e){this.statusText=e.toString()}onMessageBegin(){let{socket:e,client:t}=this;if(e.destroyed||!t[M][t[J]])return -1}onHeaderField(e){let t=this.headers.length;(1&t)==0?this.headers.push(e):this.headers[t-1]=Buffer.concat([this.headers[t-1],e]),this.trackHeader(e.length)}onHeaderValue(e){let t=this.headers.length;(1&t)==1?(this.headers.push(e),t+=1):this.headers[t-1]=Buffer.concat([this.headers[t-1],e]);let n=this.headers[t-2];10===n.length&&"keep-alive"===n.toString().toLowerCase()?this.keepAlive+=e.toString():10===n.length&&"connection"===n.toString().toLowerCase()?this.connection+=e.toString():14===n.length&&"content-length"===n.toString().toLowerCase()&&(this.contentLength+=e.toString()),this.trackHeader(e.length)}trackHeader(e){this.headersSize+=e,this.headersSize>=this.headersMaxSize&&$16nGk$pythonversioncheck7ed1514ejs1.destroy(this.socket,new E)}onUpgrade(e){let{upgrade:t,client:n,socket:s,headers:o,statusCode:r}=this;d(t);let c=n[M][n[J]];d(c),d(!s.destroyed),d(s===n[Z]),d(!this.paused),d(c.upgrade||"CONNECT"===c.method),this.statusCode=null,this.statusText="",this.shouldKeepAlive=null,d(this.headers.length%2==0),this.headers=[],this.headersSize=0,s.unshift(e),s[P].destroy(),s[P]=null,s[G]=null,s[Q]=null,s.removeListener("error",eY).removeListener("readable",eV).removeListener("end",eQ).removeListener("close",eX),n[Z]=null,n[M][n[J]++]=null,n.emit("disconnect",n[w],[n],new v("upgrade"));try{c.onUpgrade(r,o,s)}catch(e){$16nGk$pythonversioncheck7ed1514ejs1.destroy(s,e)}e0(n)}onHeadersComplete(e,t,n){let{client:s,socket:o,headers:r,statusText:c}=this;if(o.destroyed)return -1;let i=s[M][s[J]];if(!i)return -1;if(d(!this.upgrade),d(this.statusCode<200),100===e)return $16nGk$pythonversioncheck7ed1514ejs1.destroy(o,new b("bad response",$16nGk$pythonversioncheck7ed1514ejs2.getSocketInfo(o))),-1;if(t&&!i.upgrade)return $16nGk$pythonversioncheck7ed1514ejs1.destroy(o,new b("bad upgrade",$16nGk$pythonversioncheck7ed1514ejs2.getSocketInfo(o))),-1;if(d.strictEqual(this.timeoutType,1),this.statusCode=e,this.shouldKeepAlive=n||"HEAD"===i.method&&!o[T]&&"keep-alive"===this.connection.toLowerCase(),this.statusCode>=200){let e=null!=i.bodyTimeout?i.bodyTimeout:s[er];this.setTimeout(e,2)}else this.timeout&&this.timeout.refresh&&this.timeout.refresh();if("CONNECT"===i.method||t)return d(1===s[N]),this.upgrade=!0,2;if(d(this.headers.length%2==0),this.headers=[],this.headersSize=0,this.shouldKeepAlive&&s[X]){let e=this.keepAlive?$16nGk$pythonversioncheck7ed1514ejs9.parseKeepAliveTimeout(this.keepAlive):null;if(null!=e){let t=Math.min(e-s[es],s[en]);t<=0?o[T]=!0:s[ee]=t}else s[ee]=s[W]}else o[T]=!0;let h=!1===i.onHeaders(e,r,this.resume,c);return i.aborted?-1:"HEAD"===i.method||e<200?1:(o[L]&&(o[L]=!1,e0(s)),h?$16nGk$pythonversioncheck67e8c7c6js.ERROR.PAUSED:0)}onBody(e){let{client:t,socket:n,statusCode:s,maxResponseSize:o}=this;if(n.destroyed)return -1;let r=t[M][t[J]];return(d(r),d.strictEqual(this.timeoutType,2),this.timeout&&this.timeout.refresh&&this.timeout.refresh(),d(s>=200),o>-1&&this.bytesRead+e.length>o)?($16nGk$pythonversioncheck7ed1514ejs1.destroy(n,new g),-1):(this.bytesRead+=e.length,!1===r.onData(e))?$16nGk$pythonversioncheck67e8c7c6js.ERROR.PAUSED:void 0}onMessageComplete(){let{client:e,socket:t,statusCode:n,upgrade:s,headers:o,contentLength:r,bytesRead:c,shouldKeepAlive:i}=this;if(t.destroyed&&(!n||i))return -1;if(s)return;let h=e[M][e[J]];if(d(h),d(n>=100),this.statusCode=null,this.statusText="",this.bytesRead=0,this.contentLength="",this.keepAlive="",this.connection="",d(this.headers.length%2==0),this.headers=[],this.headersSize=0,!(n<200)){if("HEAD"!==h.method&&r&&c!==parseInt(r,10))return $16nGk$pythonversioncheck7ed1514ejs1.destroy(t,new H),-1;if(h.onComplete(o),e[M][e[J]++]=null,t[I])return d.strictEqual(e[N],0),$16nGk$pythonversioncheck7ed1514ejs1.destroy(t,new v("reset")),$16nGk$pythonversioncheck67e8c7c6js.ERROR.PAUSED;if(!i)return $16nGk$pythonversioncheck7ed1514ejs1.destroy(t,new v("reset")),$16nGk$pythonversioncheck67e8c7c6js.ERROR.PAUSED;if(t[T]&&0===e[N])return $16nGk$pythonversioncheck7ed1514ejs1.destroy(t,new v("reset")),$16nGk$pythonversioncheck67e8c7c6js.ERROR.PAUSED;1===e[X]?setImmediate(e0,e):e0(e)}}}function eW(e){let{socket:t,timeoutType:n,client:s}=e;1===n?(!t[I]||t.writableNeedDrain||s[N]>1)&&(d(!e.paused,"cannot be paused while waiting for headers"),$16nGk$pythonversioncheck7ed1514ejs1.destroy(t,new S)):2===n?e.paused||$16nGk$pythonversioncheck7ed1514ejs1.destroy(t,new R):3===n&&(d(0===s[N]&&s[ee]),$16nGk$pythonversioncheck7ed1514ejs1.destroy(t,new v("socket idle timeout")))}function eV(){let{[P]:e}=this;e&&e.readMore()}function eY(e){let{[G]:t,[P]:n}=this;if(d("ERR_TLS_CERT_ALTNAME_INVALID"!==e.code),"h2"!==t[em]&&"ECONNRESET"===e.code&&n.statusCode&&!n.shouldKeepAlive)return void n.onMessageComplete();this[Q]=e,eJ(this[G],e)}function eJ(e,t){if(0===e[N]&&"UND_ERR_INFO"!==t.code&&"UND_ERR_SOCKET"!==t.code){d(e[Y]===e[J]);let n=e[M].splice(e[J]);for(let s=0;s<n.length;s++)e8(e,n[s],t);d(0===e[O])}}function eQ(){let{[P]:e,[G]:t}=this;if("h2"!==t[em]&&e.statusCode&&!e.shouldKeepAlive)return void e.onMessageComplete();$16nGk$pythonversioncheck7ed1514ejs1.destroy(this,new b("other side closed",$16nGk$pythonversioncheck7ed1514ejs2.getSocketInfo(this)))}function eX(){let{[G]:e,[P]:t}=this;"h1"===e[em]&&t&&(this[Q]||!t.statusCode||t.shouldKeepAlive||t.onMessageComplete(),this[P].destroy(),this[P]=null);let n=this[Q]||new b("closed",$16nGk$pythonversioncheck7ed1514ejs2.getSocketInfo(this));if(e[Z]=null,e.destroyed){d(0===e[D]);let t=e[M].splice(e[J]);for(let s=0;s<t.length;s++)e8(e,t[s],n)}else if(e[N]>0&&"UND_ERR_INFO"!==n.code){let t=e[M][e[J]];e[M][e[J]++]=null,e8(e,t,n)}e[Y]=e[J],d(0===e[N]),e.emit("disconnect",e[w],[e],n),e0(e)}async function eZ(t){d(!t[U]),d(!t[Z]);let{host:n,hostname:s,protocol:o,port:r}=t[w];if("["===s[0]){let e=s.indexOf("]");d(-1!==e);let t=s.substring(1,e);d(f(t)),s=t}t[U]=!0,eP.beforeConnect.hasSubscribers&&eP.beforeConnect.publish({connectParams:{host:n,hostname:s,protocol:o,port:r,servername:t[j],localAddress:t[ek]},connector:t[ei]});try{let c=await new Promise((e,c)=>{t[ei]({host:n,hostname:s,protocol:o,port:r,servername:t[j],localAddress:t[ek]},(t,n)=>{t?c(t):e(n)})});if(t.destroyed)return void $16nGk$pythonversioncheck7ed1514ejs1.destroy(c.on("error",()=>{}),new F);if(t[U]=!1,d(c),"h2"===c.alpnProtocol){ej||(ej=!0,process.emitWarning("H2 support is experimental, expect them to change at any time.",{code:"UNDICI-H2"}));let n=e.connect(t[w],{createConnection:()=>c,peerMaxConcurrentStreams:t[e$].maxConcurrentStreams});t[em]="h2",n[G]=t,n[Z]=c,n.on("error",ex),n.on("frameError",eL),n.on("end",eq),n.on("goaway",eN),n.on("close",eX),n.unref(),t[e_]=n,c[e_]=n}else eO||(eO=await eI,eI=null),c[K]=!1,c[I]=!1,c[T]=!1,c[L]=!1,c[P]=new eK(t,c,eO);c[el]=0,c[ea]=t[ea],c[G]=t,c[Q]=null,c.on("error",eY).on("readable",eV).on("end",eQ).on("close",eX),t[Z]=c,eP.connected.hasSubscribers&&eP.connected.publish({connectParams:{host:n,hostname:s,protocol:o,port:r,servername:t[j],localAddress:t[ek]},connector:t[ei],socket:c}),t.emit("connect",t[w],[t])}catch(e){if(t.destroyed)return;if(t[U]=!1,eP.connectError.hasSubscribers&&eP.connectError.publish({connectParams:{host:n,hostname:s,protocol:o,port:r,servername:t[j],localAddress:t[ek]},connector:t[ei],error:e}),"ERR_TLS_CERT_ALTNAME_INVALID"===e.code)for(d(0===t[N]);t[D]>0&&t[M][t[Y]].servername===t[j];){let n=t[M][t[Y]++];e8(t,n,e)}else eJ(t,e);t.emit("connectionError",t[w],[t],e)}e0(t)}function e1(e){e[z]=0,e.emit("drain",e[w],[e])}function e0(e,t){2!==e[q]&&(e[q]=2,function(e,t){for(;;){if(e.destroyed)return void d(0===e[D]);if(e[eC]&&!e[O]){e[eC](),e[eC]=null;return}let n=e[Z];if(n&&!n.destroyed&&"h2"!==n.alpnProtocol){if(0===e[O]?!n[K]&&n.unref&&(n.unref(),n[K]=!0):n[K]&&n.ref&&(n.ref(),n[K]=!1),0===e[O])3!==n[P].timeoutType&&n[P].setTimeout(e[ee],3);else if(e[N]>0&&n[P].statusCode<200&&1!==n[P].timeoutType){let t=e[M][e[J]],s=null!=t.headersTimeout?t.headersTimeout:e[eo];n[P].setTimeout(s,1)}}if(e[C])e[z]=2;else if(2===e[z]){t?(e[z]=1,process.nextTick(e1,e)):e1(e);continue}if(0===e[D]||e[N]>=(e[X]||1))return;let o=e[M][e[Y]];if("https:"===e[w].protocol&&e[j]!==o.servername){if(e[N]>0)return;if(e[j]=o.servername,n&&n.servername!==o.servername)return void $16nGk$pythonversioncheck7ed1514ejs1.destroy(n,new v("servername changed"))}if(e[U])return;if(!n&&!e[e_])return void eZ(e);if(n.destroyed||n[I]||n[T]||n[L]||e[N]>0&&!o.idempotent||e[N]>0&&(o.upgrade||"CONNECT"===o.method)||e[N]>0&&0!==$16nGk$pythonversioncheck7ed1514ejs.bodyLength(o.body)&&($16nGk$pythonversioncheck7ed1514ejs7.isStream(o.body)||$16nGk$pythonversioncheck7ed1514ejs3.isAsyncIterable(o.body)))return;!o.aborted&&function(e,t){if("h2"===e[em])return void function(e,t,n){let o,r,{body:c,method:i,path:h,host:a,upgrade:l,expectContinue:u,signal:f,headers:p}=n;if(o="string"==typeof p?s[eE](p.trim()):p,l)return e8(e,n,Error("Upgrade not supported for H2"));try{n.onConnect(t=>{n.aborted||n.completed||e8(e,n,t||new $)})}catch(t){e8(e,n,t)}if(n.aborted)return;let k=e[e$];if(o[ev]=a||e[eH],o[eR]=i,"CONNECT"===i)return t.ref(),(r=t.request(o,{endStream:!1,signal:f})).id&&!r.pending?(n.onUpgrade(null,null,r),++k.openStreams):r.once("ready",()=>{n.onUpgrade(null,null,r),++k.openStreams}),r.once("close",()=>{k.openStreams-=1,0===k.openStreams&&t.unref()});o[eA]=h,o[eg]="https";let y="PUT"===i||"POST"===i||"PATCH"===i;c&&"function"==typeof c.read&&c.read(0);let H=$16nGk$pythonversioncheck7ed1514ejs.bodyLength(c);if(null==H&&(H=n.contentLength),0!==H&&y||(H=null),e6(i)&&H>0&&null!=n.contentLength&&n.contentLength!==H){if(e[ec])return e8(e,n,new m);process.emitWarning(new m)}null!=H&&(d(c,"no body must not have content length"),o[eF]=`${H}`),t.ref();let _="GET"===i||"HEAD"===i;return u?(o[ew]="100-continue",(r=t.request(o,{endStream:_,signal:f})).once("continue",S)):(r=t.request(o,{endStream:_,signal:f}),S()),++k.openStreams,r.once("response",e=>{let{[eT]:t,...s}=e;!1===n.onHeaders(Number(t),s,r.resume.bind(r),"")&&r.pause()}),r.once("end",()=>{n.onComplete([])}),r.on("data",e=>{!1===n.onData(e)&&r.pause()}),r.once("close",()=>{k.openStreams-=1,0===k.openStreams&&t.unref()}),r.once("error",function(t){!e[e_]||e[e_].destroyed||this.closed||this.destroyed||(k.streams-=1,$16nGk$pythonversioncheck7ed1514ejs1.destroy(r,t))}),r.once("frameError",(t,s)=>{let o=new v(`HTTP/2: "frameError" received - type ${t}, code ${s}`);e8(e,n,o),!e[e_]||e[e_].destroyed||this.closed||this.destroyed||(k.streams-=1,$16nGk$pythonversioncheck7ed1514ejs1.destroy(r,o))});function S(){c?$16nGk$pythonversioncheck7ed1514ejs5.isBuffer(c)?(d(H===c.byteLength,"buffer body must have content length"),r.cork(),r.write(c),r.uncork(),r.end(),n.onBodySent(c),n.onRequestSent()):$16nGk$pythonversioncheck7ed1514ejs4.isBlobLike(c)?"function"==typeof c.stream?e2({client:e,request:n,contentLength:H,h2stream:r,expectsPayload:y,body:c.stream(),socket:e[Z],header:""}):e4({body:c,client:e,request:n,contentLength:H,expectsPayload:y,h2stream:r,header:"",socket:e[Z]}):$16nGk$pythonversioncheck7ed1514ejs7.isStream(c)?e3({body:c,client:e,request:n,contentLength:H,expectsPayload:y,socket:e[Z],h2stream:r,header:""}):$16nGk$pythonversioncheck7ed1514ejs6.isIterable(c)?e2({body:c,client:e,request:n,contentLength:H,expectsPayload:y,header:"",h2stream:r,socket:e[Z]}):d(!1):n.onRequestSent()}}(e,e[e_],t);let{body:n,method:o,path:r,host:c,upgrade:i,headers:h,blocking:a,reset:l}=t,u="PUT"===o||"POST"===o||"PATCH"===o;n&&"function"==typeof n.read&&n.read(0);let f=$16nGk$pythonversioncheck7ed1514ejs.bodyLength(n),p=f;if(null===p&&(p=t.contentLength),0!==p||u||(p=null),e6(o)&&p>0&&null!==t.contentLength&&t.contentLength!==p){if(e[ec])return e8(e,t,new m),!1;process.emitWarning(new m)}let k=e[Z];try{t.onConnect(n=>{t.aborted||t.completed||(e8(e,t,n||new $),$16nGk$pythonversioncheck7ed1514ejs1.destroy(k,new v("aborted")))})}catch(n){e8(e,t,n)}if(t.aborted)return!1;"HEAD"===o&&(k[T]=!0),(i||"CONNECT"===o)&&(k[T]=!0),null!=l&&(k[T]=l),e[ea]&&k[el]++>=e[ea]&&(k[T]=!0),a&&(k[L]=!0);let y=`${o} ${r} HTTP/1.1\r
`;return"string"==typeof c?y+=`host: ${c}\r
`:y+=e[V],i?y+=`connection: upgrade\r
upgrade: ${i}\r
`:e[X]&&!k[T]?y+="connection: keep-alive\r\n":y+="connection: close\r\n",h&&(y+=h),eP.sendHeaders.hasSubscribers&&eP.sendHeaders.publish({request:t,headers:y,socket:k}),n&&0!==f?$16nGk$pythonversioncheck7ed1514ejs5.isBuffer(n)?(d(p===n.byteLength,"buffer body must have content length"),k.cork(),k.write(`${y}content-length: ${p}\r
\r
`,"latin1"),k.write(n),k.uncork(),t.onBodySent(n),t.onRequestSent(),u||(k[T]=!0)):$16nGk$pythonversioncheck7ed1514ejs4.isBlobLike(n)?"function"==typeof n.stream?e2({body:n.stream(),client:e,request:t,socket:k,contentLength:p,header:y,expectsPayload:u}):e4({body:n,client:e,request:t,socket:k,contentLength:p,header:y,expectsPayload:u}):$16nGk$pythonversioncheck7ed1514ejs7.isStream(n)?e3({body:n,client:e,request:t,socket:k,contentLength:p,header:y,expectsPayload:u}):$16nGk$pythonversioncheck7ed1514ejs6.isIterable(n)?e2({body:n,client:e,request:t,socket:k,contentLength:p,header:y,expectsPayload:u}):d(!1):(0===p?k.write(`${y}content-length: 0\r
\r
`,"latin1"):(d(null===p,"no body must not have content length"),k.write(`${y}\r
`,"latin1")),t.onRequestSent()),!0}(e,o)?e[Y]++:e[M].splice(e[Y],1)}}(e,t),e[q]=0,e[J]>256&&(e[M].splice(0,e[J]),e[Y]-=e[J],e[J]=0))}function e6(e){return"GET"!==e&&"HEAD"!==e&&"OPTIONS"!==e&&"TRACE"!==e&&"CONNECT"!==e}function e3({h2stream:e,body:t,client:n,request:s,socket:o,contentLength:r,header:c,expectsPayload:i}){if(d(0!==r||0===n[N],"stream body cannot be pipelined"),"h2"===n[em]){let n=k(t,e,n=>{n?($16nGk$pythonversioncheck7ed1514ejs1.destroy(t,n),$16nGk$pythonversioncheck7ed1514ejs1.destroy(e,n)):s.onRequestSent()});function h(e){s.onBodySent(e)}n.on("data",h),n.once("end",()=>{n.removeListener("data",h),$16nGk$pythonversioncheck7ed1514ejs1.destroy(n)});return}let a=!1,l=new e7({socket:o,request:s,contentLength:r,client:n,expectsPayload:i,header:c}),u=function(e){if(!a)try{!l.write(e)&&this.pause&&this.pause()}catch(e){$16nGk$pythonversioncheck7ed1514ejs1.destroy(this,e)}},f=function(){!a&&t.resume&&t.resume()},p=function(){if(a)return;let e=new $;queueMicrotask(()=>y(e))},y=function(e){if(!a){if(a=!0,d(o.destroyed||o[I]&&n[N]<=1),o.off("drain",f).off("error",y),t.removeListener("data",u).removeListener("end",y).removeListener("error",y).removeListener("close",p),!e)try{l.end()}catch(t){e=t}l.destroy(e),e&&("UND_ERR_INFO"!==e.code||"reset"!==e.message)?$16nGk$pythonversioncheck7ed1514ejs1.destroy(t,e):$16nGk$pythonversioncheck7ed1514ejs1.destroy(t)}};t.on("data",u).on("end",y).on("error",y).on("close",p),t.resume&&t.resume(),o.on("drain",f).on("error",y)}async function e4({h2stream:e,body:t,client:n,request:s,socket:o,contentLength:r,header:c,expectsPayload:i}){d(r===t.size,"blob body must have content length");let h="h2"===n[em];try{if(null!=r&&r!==t.size)throw new m;let a=Buffer.from(await t.arrayBuffer());h?(e.cork(),e.write(a),e.uncork()):(o.cork(),o.write(`${c}content-length: ${r}\r
\r
`,"latin1"),o.write(a),o.uncork()),s.onBodySent(a),s.onRequestSent(),i||(o[T]=!0),e0(n)}catch(t){$16nGk$pythonversioncheck7ed1514ejs1.destroy(h?e:o,t)}}async function e2({h2stream:e,body:t,client:n,request:s,socket:o,contentLength:r,header:c,expectsPayload:i}){d(0!==r||0===n[N],"iterator body cannot be pipelined");let h=null;function a(){if(h){let e=h;h=null,e()}}let l=()=>new Promise((e,t)=>{d(null===h),o[Q]?t(o[Q]):h=e});if("h2"===n[em]){e.on("close",a).on("drain",a);try{for await(let n of t){if(o[Q])throw o[Q];let t=e.write(n);s.onBodySent(n),t||await l()}}catch(t){e.destroy(t)}finally{s.onRequestSent(),e.end(),e.off("close",a).off("drain",a)}return}o.on("close",a).on("drain",a);let u=new e7({socket:o,request:s,contentLength:r,client:n,expectsPayload:i,header:c});try{for await(let e of t){if(o[Q])throw o[Q];u.write(e)||await l()}u.end()}catch(e){u.destroy(e)}finally{o.off("close",a).off("drain",a)}}class e7{constructor({socket:e,request:t,contentLength:n,client:s,expectsPayload:o,header:r}){this.socket=e,this.request=t,this.contentLength=n,this.client=s,this.bytesWritten=0,this.expectsPayload=o,this.header=r,e[I]=!0}write(e){let{socket:t,request:n,contentLength:s,client:o,bytesWritten:r,expectsPayload:c,header:i}=this;if(t[Q])throw t[Q];if(t.destroyed)return!1;let h=Buffer.byteLength(e);if(!h)return!0;if(null!==s&&r+h>s){if(o[ec])throw new m;process.emitWarning(new m)}t.cork(),0===r&&(c||(t[T]=!0),null===s?t.write(`${i}transfer-encoding: chunked\r
`,"latin1"):t.write(`${i}content-length: ${s}\r
\r
`,"latin1")),null===s&&t.write(`\r
${h.toString(16)}\r
`,"latin1"),this.bytesWritten+=h;let a=t.write(e);return t.uncork(),n.onBodySent(e),!a&&t[P].timeout&&1===t[P].timeoutType&&t[P].timeout.refresh&&t[P].timeout.refresh(),a}end(){let{socket:e,contentLength:t,client:n,bytesWritten:s,expectsPayload:o,header:r,request:c}=this;if(c.onRequestSent(),e[I]=!1,e[Q])throw e[Q];if(!e.destroyed){if(0===s?o?e.write(`${r}content-length: 0\r
\r
`,"latin1"):e.write(`${r}\r
`,"latin1"):null===t&&e.write("\r\n0\r\n\r\n","latin1"),null!==t&&s!==t)if(n[ec])throw new m;else process.emitWarning(new m);e[P].timeout&&1===e[P].timeoutType&&e[P].timeout.refresh&&e[P].timeout.refresh(),e0(n)}}destroy(e){let{socket:t,client:n}=this;t[I]=!1,e&&(d(n[N]<=1,"pipeline should only contain this request"),$16nGk$pythonversioncheck7ed1514ejs1.destroy(t,e))}}function e8(e,t,n){try{t.onError(n),d(t.aborted)}catch(t){e.emit("error",t)}}y=class extends o{constructor(e,{interceptors:n,maxHeaderSize:s,headersTimeout:o,socketTimeout:r,requestTimeout:i,connectTimeout:h,bodyTimeout:l,idleTimeout:u,keepAlive:d,keepAliveTimeout:k,maxKeepAliveTimeout:y,keepAliveMaxTimeout:m,keepAliveTimeoutThreshold:H,socketPath:$,pipelining:S,tls:E,strictContentLength:b,maxCachedSessions:v,maxRedirections:R,connect:A,maxRequestsPerClient:g,localAddress:F,maxResponseSize:T,autoSelectFamily:G,autoSelectFamilyAttemptTimeout:C,allowH2:P,maxConcurrentStreams:x}={}){if(super(),void 0!==d)throw new _("unsupported keepAlive, use pipelining=0 instead");if(void 0!==r)throw new _("unsupported socketTimeout, use headersTimeout & bodyTimeout instead");if(void 0!==i)throw new _("unsupported requestTimeout, use headersTimeout & bodyTimeout instead");if(void 0!==u)throw new _("unsupported idleTimeout, use keepAliveTimeout instead");if(void 0!==y)throw new _("unsupported maxKeepAliveTimeout, use keepAliveMaxTimeout instead");if(null!=s&&!Number.isFinite(s))throw new _("invalid maxHeaderSize");if(null!=$&&"string"!=typeof $)throw new _("invalid socketPath");if(null!=h&&(!Number.isFinite(h)||h<0))throw new _("invalid connectTimeout");if(null!=k&&(!Number.isFinite(k)||k<=0))throw new _("invalid keepAliveTimeout");if(null!=m&&(!Number.isFinite(m)||m<=0))throw new _("invalid keepAliveMaxTimeout");if(null!=H&&!Number.isFinite(H))throw new _("invalid keepAliveTimeoutThreshold");if(null!=o&&(!Number.isInteger(o)||o<0))throw new _("headersTimeout must be a positive integer or zero");if(null!=l&&(!Number.isInteger(l)||l<0))throw new _("bodyTimeout must be a positive integer or zero");if(null!=A&&"function"!=typeof A&&"object"!=typeof A)throw new _("connect must be a function or an object");if(null!=R&&(!Number.isInteger(R)||R<0))throw new _("maxRedirections must be a positive number");if(null!=g&&(!Number.isInteger(g)||g<0))throw new _("maxRequestsPerClient must be a positive number");if(null!=F&&("string"!=typeof F||0===f(F)))throw new _("localAddress must be valid string IP address");if(null!=T&&(!Number.isInteger(T)||T<-1))throw new _("maxResponseSize must be a positive number");if(null!=C&&(!Number.isInteger(C)||C<-1))throw new _("autoSelectFamilyAttemptTimeout must be a positive number");if(null!=P&&"boolean"!=typeof P)throw new _("allowH2 must be a valid boolean value");if(null!=x&&("number"!=typeof x||x<1))throw new _("maxConcurrentStreams must be a possitive integer, greater than 0");"function"!=typeof A&&(A=c({...E,maxCachedSessions:v,allowH2:P,socketPath:$,timeout:h,...$16nGk$pythonversioncheck7ed1514ejs8.nodeHasAutoSelectFamily&&G?{autoSelectFamily:G,autoSelectFamilyAttemptTimeout:C}:void 0,...A})),this[ep]=n&&n.Client&&Array.isArray(n.Client)?n.Client:[a({maxRedirections:R})],this[w]=t.parseOrigin(e),this[ei]=A,this[Z]=null,this[X]=null!=S?S:1,this[et]=s||p,this[W]=null==k?4e3:k,this[en]=null==m?6e5:m,this[es]=null==H?1e3:H,this[ee]=this[W],this[j]=null,this[ek]=null!=F?F:null,this[q]=0,this[z]=0,this[V]=`host: ${this[w].hostname}${this[w].port?`:${this[w].port}`:""}\r
`,this[er]=null!=l?l:3e5,this[eo]=null!=o?o:3e5,this[ec]=null==b||b,this[eh]=R,this[ea]=g,this[eC]=null,this[ey]=T>-1?T:-1,this[em]="h1",this[e_]=null,this[e$]=P?{openStreams:0,maxConcurrentStreams:null!=x?x:100}:null,this[eH]=`${this[w].hostname}${this[w].port?`:${this[w].port}`:""}`,this[M]=[],this[J]=0,this[Y]=0}get pipelining(){return this[X]}set pipelining(e){this[X]=e,e0(this,!0)}get[D](){return this[M].length-this[Y]}get[N](){return this[Y]-this[J]}get[O](){return this[M].length-this[J]}get[B](){return!!this[Z]&&!this[U]&&!this[Z].destroyed}get[C](){let e=this[Z];return e&&(e[T]||e[I]||e[L])||this[O]>=(this[X]||1)||this[D]>0}[x](e){eZ(this),this.once("connect",e)}[ef](e,t){let n=e.origin||this[w].origin,o="h2"===this[em]?s[eS](n,e,t):s[eb](n,e,t);return this[M].push(o),this[q]||(null==$16nGk$pythonversioncheck7ed1514ejs.bodyLength(o.body)&&$16nGk$pythonversioncheck7ed1514ejs6.isIterable(o.body)?(this[q]=1,process.nextTick(e0,this)):e0(this,!0)),this[q]&&2!==this[z]&&this[C]&&(this[z]=2),this[z]<2}async [eu](){return new Promise(e=>{this[O]?this[eC]=e:e(null)})}async [ed](e){return new Promise(t=>{let n=this[M].splice(this[Y]);for(let t=0;t<n.length;t++)e8(this,n[t],e);let s=()=>{this[eC]&&(this[eC](),this[eC]=null),t()};null!=this[e_]&&($16nGk$pythonversioncheck7ed1514ejs1.destroy(this[e_],e),this[e_]=null,this[e$]=null),this[Z]?$16nGk$pythonversioncheck7ed1514ejs1.destroy(this[Z].on("close",s),e):queueMicrotask(s),e0(this)})}};export{y as default};
//# sourceMappingURL=python-version-check.171f2d6c.js.map
