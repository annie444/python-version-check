let e;import t from"./python-version-check.dba5a2d4.js";import r from"./python-version-check.ebf2a848.js";import n from"./python-version-check.7ed1514e.js";import s from"./python-version-check.152f8bba.js";import*as o from"assert";var i={},h=$8hD8m$pythonversioncheckdba5a2d4js.InvalidArgumentError,a=t.NotSupportedError,l=$8hD8m$pythonversioncheckebf2a848js1.kHTTP2BuildRequest,c=r.kHTTP2CopyHeaders,d=$8hD8m$pythonversioncheckebf2a848js.kHTTP1BuildRequest;let f=/^[\^_`a-zA-Z\-0-9!#$%&'*+.|~]+$/,u=/[^\t\x20-\x7e\x80-\xff]/,b=/[^\u0021-\u00ff]/,y=Symbol("handler"),p={};try{let e=$c2599bb4e4cabbe9$import$6aef8f873045faa5;p.create=e.channel("undici:request:create"),p.bodySent=e.channel("undici:request:bodySent"),p.headers=e.channel("undici:request:headers"),p.trailers=e.channel("undici:request:trailers"),p.error=e.channel("undici:request:error")}catch{p.create={hasSubscribers:!1},p.bodySent={hasSubscribers:!1},p.headers={hasSubscribers:!1},p.trailers={hasSubscribers:!1},p.error={hasSubscribers:!1}}class m{constructor(t,{path:r,method:o,body:i,headers:a,query:l,idempotent:c,blocking:d,upgrade:u,headersTimeout:m,bodyTimeout:w,reset:g,throwOnError:$,expectContinue:v},S){if("string"!=typeof r)throw new h("path must be a string");if("/"===r[0]||r.startsWith("http://")||r.startsWith("https://")||"CONNECT"===o){if(null!==b.exec(r))throw new h("invalid request path")}else throw new h("path must be an absolute URL or start with a slash");if("string"!=typeof o)throw new h("method must be a string");if(null===f.exec(o))throw new h("invalid request method");if(u&&"string"!=typeof u)throw new h("upgrade must be a string");if(null!=m&&(!Number.isFinite(m)||m<0))throw new h("invalid headersTimeout");if(null!=w&&(!Number.isFinite(w)||w<0))throw new h("invalid bodyTimeout");if(null!=g&&"boolean"!=typeof g)throw new h("invalid reset");if(null!=v&&"boolean"!=typeof v)throw new h("invalid expectContinue");if(this.headersTimeout=m,this.bodyTimeout=w,this.throwOnError=!0===$,this.method=o,this.abort=null,null==i)this.body=null;else if($8hD8m$pythonversioncheck7ed1514ejs7.isStream(i)){this.body=i;let e=this.body._readableState;e&&e.autoDestroy||(this.endHandler=function(){$8hD8m$pythonversioncheck7ed1514ejs1.destroy(this)},this.body.on("end",this.endHandler)),this.errorHandler=e=>{this.abort?this.abort(e):this.error=e},this.body.on("error",this.errorHandler)}else if($8hD8m$pythonversioncheck7ed1514ejs4.isBuffer(i))this.body=i.byteLength?i:null;else if(ArrayBuffer.isView(i))this.body=i.buffer.byteLength?Buffer.from(i.buffer,i.byteOffset,i.byteLength):null;else if(i instanceof ArrayBuffer)this.body=i.byteLength?Buffer.from(i):null;else if("string"==typeof i)this.body=i.length?Buffer.from(i):null;else if($8hD8m$pythonversioncheck7ed1514ejs5.isFormDataLike(i)||$8hD8m$pythonversioncheck7ed1514ejs6.isIterable(i)||$8hD8m$pythonversioncheck7ed1514ejs3.isBlobLike(i))this.body=i;else throw new h("body must be a string, a Buffer, a Readable stream, an iterable, or an async iterable");if(this.completed=!1,this.aborted=!1,this.upgrade=u||null,this.path=l?$8hD8m$pythonversioncheck7ed1514ejs.buildURL(r,l):r,this.origin=t,this.idempotent=null==c?"HEAD"===o||"GET"===o:c,this.blocking=null!=d&&d,this.reset=null==g?null:g,this.host=null,this.contentLength=null,this.contentType=null,this.headers="",this.expectContinue=null!=v&&v,Array.isArray(a)){if(a.length%2!=0)throw new h("headers array must be even");for(let e=0;e<a.length;e+=2)H(this,a[e],a[e+1])}else if(a&&"object"==typeof a){let e=Object.keys(a);for(let t=0;t<e.length;t++){let r=e[t];H(this,r,a[r])}}else if(null!=a)throw new h("headers must be an object or an array");if($8hD8m$pythonversioncheck7ed1514ejs5.isFormDataLike(this.body)){if($8hD8m$pythonversioncheck7ed1514ejs8.nodeMajor<16||16===$8hD8m$pythonversioncheck7ed1514ejs8.nodeMajor&&$8hD8m$pythonversioncheck7ed1514ejs9.nodeMinor<8)throw new h("Form-Data bodies are only supported in node v16.8 and newer.");e||(e=s.extractBody);let[t,r]=e(i);null==this.contentType&&(this.contentType=r,this.headers+=`content-type: ${r}\r
`),this.body=t.stream,this.contentLength=t.length}else $8hD8m$pythonversioncheck7ed1514ejs3.isBlobLike(i)&&null==this.contentType&&i.type&&(this.contentType=i.type,this.headers+=`content-type: ${i.type}\r
`);n.validateHandler(S,o,u),this.servername=$8hD8m$pythonversioncheck7ed1514ejs2.getServerName(this.host),this[y]=S,p.create.hasSubscribers&&p.create.publish({request:this})}onBodySent(e){if(this[y].onBodySent)try{return this[y].onBodySent(e)}catch(e){this.abort(e)}}onRequestSent(){if(p.bodySent.hasSubscribers&&p.bodySent.publish({request:this}),this[y].onRequestSent)try{return this[y].onRequestSent()}catch(e){this.abort(e)}}onConnect(e){if(o(!this.aborted),o(!this.completed),!this.error)return this.abort=e,this[y].onConnect(e);e(this.error)}onHeaders(e,t,r,n){o(!this.aborted),o(!this.completed),p.headers.hasSubscribers&&p.headers.publish({request:this,response:{statusCode:e,headers:t,statusText:n}});try{return this[y].onHeaders(e,t,r,n)}catch(e){this.abort(e)}}onData(e){o(!this.aborted),o(!this.completed);try{return this[y].onData(e)}catch(e){return this.abort(e),!1}}onUpgrade(e,t,r){return o(!this.aborted),o(!this.completed),this[y].onUpgrade(e,t,r)}onComplete(e){this.onFinally(),o(!this.aborted),this.completed=!0,p.trailers.hasSubscribers&&p.trailers.publish({request:this,trailers:e});try{return this[y].onComplete(e)}catch(e){this.onError(e)}}onError(e){if(this.onFinally(),p.error.hasSubscribers&&p.error.publish({request:this,error:e}),!this.aborted)return this.aborted=!0,this[y].onError(e)}onFinally(){this.errorHandler&&(this.body.off("error",this.errorHandler),this.errorHandler=null),this.endHandler&&(this.body.off("end",this.endHandler),this.endHandler=null)}addHeader(e,t){return H(this,e,t),this}static[d](e,t,r){return new m(e,t,r)}static[l](e,t,r){let n=t.headers,s=new m(e,t={...t,headers:null},r);if(s.headers={},Array.isArray(n)){if(n.length%2!=0)throw new h("headers array must be even");for(let e=0;e<n.length;e+=2)H(s,n[e],n[e+1],!0)}else if(n&&"object"==typeof n){let e=Object.keys(n);for(let t=0;t<e.length;t++){let r=e[t];H(s,r,n[r],!0)}}else if(null!=n)throw new h("headers must be an object or an array");return s}static[c](e){let t=e.split("\r\n"),r={};for(let e of t){let[t,n]=e.split(": ");null!=n&&0!==n.length&&(r[t]?r[t]+=`,${n}`:r[t]=n)}return r}}function w(e,t,r){if(t&&"object"==typeof t||(t=null!=t?`${t}`:"",null!==u.exec(t)))throw new h(`invalid ${e} header`);return r?t:`${e}: ${t}\r
`}function H(e,t,r,n=!1){if(r&&"object"==typeof r&&!Array.isArray(r))throw new h(`invalid ${t} header`);if(void 0!==r)if(null===e.host&&4===t.length&&"host"===t.toLowerCase()){if(null!==u.exec(r))throw new h(`invalid ${t} header`);e.host=r}else if(null===e.contentLength&&14===t.length&&"content-length"===t.toLowerCase()){if(e.contentLength=parseInt(r,10),!Number.isFinite(e.contentLength))throw new h("invalid content-length header")}else if(null===e.contentType&&12===t.length&&"content-type"===t.toLowerCase())e.contentType=r,n?e.headers[t]=w(t,r,n):e.headers+=w(t,r);else if(17===t.length&&"transfer-encoding"===t.toLowerCase())throw new h("invalid transfer-encoding header");else if(10===t.length&&"connection"===t.toLowerCase()){let t="string"==typeof r?r.toLowerCase():null;if("close"!==t&&"keep-alive"!==t)throw new h("invalid connection header");"close"===t&&(e.reset=!0)}else if(10===t.length&&"keep-alive"===t.toLowerCase())throw new h("invalid keep-alive header");else if(7===t.length&&"upgrade"===t.toLowerCase())throw new h("invalid upgrade header");else if(6===t.length&&"expect"===t.toLowerCase())throw new a("expect header not supported");else if(null===f.exec(t))throw new h("invalid header key");else if(Array.isArray(r))for(let s=0;s<r.length;s++)n?e.headers[t]?e.headers[t]+=`,${w(t,r[s],n)}`:e.headers[t]=w(t,r[s],n):e.headers+=w(t,r[s]);else n?e.headers[t]=w(t,r,n):e.headers+=w(t,r)}i=m;export{i as default};
//# sourceMappingURL=python-version-check.2f514258.js.map
