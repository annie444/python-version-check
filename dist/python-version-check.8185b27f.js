import t from"./python-version-check.8a1cf8f2.js";import e from"./python-version-check.dba5a2d4.js";import r from"./python-version-check.ebf2a848.js";var i={},s=$6NItr$pythonversioncheckdba5a2d4js1.ClientDestroyedError,o=$6NItr$pythonversioncheckdba5a2d4js.ClientClosedError,n=e.InvalidArgumentError,h=$6NItr$pythonversioncheckebf2a848js1.kDestroy,c=$6NItr$pythonversioncheckebf2a848js.kClose,l=$6NItr$pythonversioncheckebf2a848js2.kDispatch,u=r.kInterceptors;let f=Symbol("destroyed"),p=Symbol("closed"),d=Symbol("onDestroyed"),a=Symbol("onClosed"),y=Symbol("Intercepted Dispatch");i=class extends t{constructor(){super(),this[f]=!1,this[d]=null,this[p]=!1,this[a]=[]}get destroyed(){return this[f]}get closed(){return this[p]}get interceptors(){return this[u]}set interceptors(t){if(t){for(let e=t.length-1;e>=0;e--)if("function"!=typeof this[u][e])throw new n("interceptor must be an function")}this[u]=t}close(t){if(void 0===t)return new Promise((t,e)=>{this.close((r,i)=>r?e(r):t(i))});if("function"!=typeof t)throw new n("invalid callback");if(this[f])return void queueMicrotask(()=>t(new s,null));if(this[p])return void(this[a]?this[a].push(t):queueMicrotask(()=>t(null,null)));this[p]=!0,this[a].push(t);let e=()=>{let t=this[a];this[a]=null;for(let e=0;e<t.length;e++)t[e](null,null)};this[c]().then(()=>this.destroy()).then(()=>{queueMicrotask(e)})}destroy(t,e){if("function"==typeof t&&(e=t,t=null),void 0===e)return new Promise((e,r)=>{this.destroy(t,(t,i)=>t?r(t):e(i))});if("function"!=typeof e)throw new n("invalid callback");if(this[f])return void(this[d]?this[d].push(e):queueMicrotask(()=>e(null,null)));t||(t=new s),this[f]=!0,this[d]=this[d]||[],this[d].push(e);let r=()=>{let t=this[d];this[d]=null;for(let e=0;e<t.length;e++)t[e](null,null)};this[h](t).then(()=>{queueMicrotask(r)})}[y](t,e){if(!this[u]||0===this[u].length)return this[y]=this[l],this[l](t,e);let r=this[l].bind(this);for(let t=this[u].length-1;t>=0;t--)r=this[u][t](r);return this[y]=r,r(t,e)}dispatch(t,e){if(!e||"object"!=typeof e)throw new n("handler must be an object");try{if(!t||"object"!=typeof t)throw new n("opts must be an object.");if(this[f]||this[d])throw new s;if(this[p])throw new o;return this[y](t,e)}catch(t){if("function"!=typeof e.onError)throw new n("invalid onError method");return e.onError(t),!1}}};export{i as default};
//# sourceMappingURL=python-version-check.8185b27f.js.map
